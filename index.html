<!DOCTYPE HTML>
<html>
	<head>
		<title>Shiny Bingo Card</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
        <link rel="stylesheet" href="assets/css/fontawesome-all.min.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<div class="logo">
							<span class="fas fa-dice-d20"></span>
						    </div>
                            <nav>
                                <ul>
                                    <li><button id="exportButton">Export as PNG</button></li>
                                    <li>
                                        <div class="button-group">
                                        <button>Free Space: </button>
                                        <button>
                                            <input id="freeSpaceNumber" min="1" max="1025" placeholder="Enter #" />
                                        </button>
                                            <select id="freeSpaceGeneration">
                                                <option value="SV">SV</option>
                                                <option value="PLA">PLA</option>
                                                <option value="SS">SS</option>
                                                <option value="BDSP">BDSP</option>
                                                <option value="LGPE">LGPE</option>
                                                <option value="XY">XY</option>
                                                <option value="BW">BW</option>
                                                <option value="HGSS">HGSS</option>
                                                <option value="DPPT">DPPT</option>
                                                <option value="FRLG">FRLG</option>
                                                <option value="RSE">RSE</option>
                                                <option value="GSC">GSC</option>
                                            </select>
                                        <button id="freeSpaceButton">Set</button>
                                    </div>
                                    </li>
                                    <li><button><a href="#intro">How to Use...</a></button></li>
                                </ul>
                            </nav>
                        <div class="content">
							<div class="inner">
                                <div id="exportArea">
                                    <h2>Shiny Bingo Card</h2>
								<table id="bingoTable" class="table table-bordered">
									<thead>
										<tr>
											<th style="text-align: center; padding-top: 30px;"><H1>B</H1></th>
											<th style="text-align: center;"><H1>I</H1></th>
											<th style="text-align: center;"><H1>N</H1></th>
											<th style="text-align: center;"><H1>G</H1></th>
											<th style="text-align: center;"><H1>O</H1></th>
										</tr>
									</thead>
									<tbody>
                                        <tr>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon"/>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img id="freeSpace" src="images/Pokemon/SV/013.png" alt="Image 13" class="pokemon" />
                                                    <img id="freeSpaceGen" src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="image-container">
                                                    <img src="images/Pokemon/SV/001.png" alt="Image 1" class="pokemon" />
                                                    <img src="images/Icons/RSE.png" alt="Icon" class="icon" />
                                                </div>
                                            </td>
                                        </tr>
									</tbody>
								</table>
                            </div>
							</div>
						</div>

                    </header>
                    <div id="main">
                        
                        <!-- Intro -->
                        <article id="intro">
                            <h2 class="major">How to Use...</h2>
                            <span class="image main"><img src="images/pic01.jpg" alt="" /></span>
                            <p>TODO</p>
                            <p>Actually write out how to use this...</p>
                            <p>TLDR; refresh to randomize, click to randomize, set the center as you like using Pokedex Number and Generateion from dropdown</p>
                        </article>
                    </div>
                </div>
                    <!-- BG -->
                    <div id="bg"></div>
                    
                    <!-- Scripts -->
                     
                    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                    <script src="assets/js/jquery.min.js"></script>
                    <script src="assets/js/browser.min.js"></script>
                    <script src="assets/js/breakpoints.min.js"></script>
                    <script src="assets/js/util.js"></script>
                    <script src="assets/js/main.js"></script>
                        <!-- Include html2canvas -->
                        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>


                        <script>
                            $(document).ready(function() {
                                $('#bingoTable').updateImageUrls();
                                setTimeout(function() {
                                $('.logo .fas').removeClass('spin');
                                }, 500); // Remove the spin class after 0.5 seconds

                                // Add click event listener to update image URL on click
                                $('#bingoTable img').on('click', function() {
                                    var $img = $(this);
                                    var folders = ['SV', 'SS', 'XY', 'BW', 'DPPT', 'HGSS', 'GSC', 'RSE']; // Add more folders as needed
                                    var icons = {
                                        'SV': 'images/Icons/SV.png',
                                        'SS': 'images/Icons/SS.png',
                                        'BDSP': 'images/Icons/BDSP.png',
                                        'LGPE': 'images/Icons/LGPE.png',
                                        'XY': 'images/Icons/XY.png',
                                        'BW': 'images/Icons/BW.png',
                                        'DPPT': 'images/Icons/DPPT_HGSS.png',
                                        'HGSS': 'images/Icons/DPPT_HGSS.png',
                                        'GSC': 'images/Icons/GSC.png',
                                        'FRLG': 'images/Icons/FRLG.png',
                                        'RSE': 'images/Icons/RSE.png'
                                    };
                                    var isValidImage = false;

                                    function tryLoadImage() {
                                        var randomFolder = folders[Math.floor(Math.random() * folders.length)];
                                        var randomNum = Math.floor(Math.random() * 1025) + 1;
                                        var formattedNum = randomNum.toString().padStart(3, '0');
                                        var newUrl = 'images/Pokemon/' + randomFolder + '/' + formattedNum + '.png';
                                        if (randomFolder == 'SS') {
                                            var randomSubFolder = Math.random();
                                            if (randomSubFolder < 0.25) {
                                                randomFolder = 'SS';
                                            }
                                            else if (randomSubFolder < 0.50 && randomNum <= 493) {
                                                randomFolder = 'BDSP';
                                            }
                                            else if (randomSubFolder < 0.75 && ([722,723,724,155,156,157,501,502,503,399,400,396,397,398,403,404,405,265,266,267,268,269,77,78,133,134,135,136,196,197,470,471,700,41,42,169,425,426,401,402,418,419,412,413,414,74,75,76,234,899,446,143,46,47,172,25,26,63,64,65,390,391,392,427,428,420,421,54,55,415,416,123,900,212,214,439,122,190,424,129,130,422,423,211,904,440,113,242,406,315,407,455,548,549,114,465,339,340,453,454,280,281,282,475,193,469,449,450,417,434,435,216,217,901,704,705,706,95,208,111,112,464,438,185,108,463,175,176,468,387,388,389,137,233,474,92,93,94,442,198,430,201,363,364,365,223,224,451,452,58,59,431,432,66,67,68,441,355,356,477,393,394,395,458,226,550,902,37,37,38,38,72,73,456,457,240,126,467,81,82,462,436,437,239,125,466,207,472,443,443,445,299,476,100,101,479,433,358,200,429,173,35,36,215,215,903,461,361,362,478,408,409,410,411,220,221,473,712,713,459,460,570,571,627,628,447,448,480,481,482,485,486,488,641,642,646,905,483,483,484,484,487,489,490,493,492,491].includes(randomNum)) ) {
                                                randomFolder = 'PLA';
                                            }
                                            else {randomFolder = 'LGPE';}
                                        }
                                        else if (randomFolder == 'RSE') {
                                            var randomSubFolder = Math.random();
                                            if (randomSubFolder < 0.5) {
                                                randomFolder = 'RSE';
                                            }else{randomFolder = 'FRLG';}
                                        }
                                        var iconUrl = icons[randomFolder];

                                        // Check if the image exists
                                        var img = new Image();
                                        img.src = newUrl;
                                        img.onload = function() {
                                            isValidImage = true;
                                            $img.attr('src', newUrl);
                                            $img.siblings('.icon').attr('src', iconUrl);
                                        };
                                        img.onerror = function() {
                                            isValidImage = false;
                                            try {
                                                tryLoadImage();
                                            } catch (e) {
                                                console.warn('Failed to load image:', e);
                                            }
                                        };
                                    }

                                    try {
                                        tryLoadImage();
                                    } catch (e) {
                                        console.warn('Failed to load image:', e);
                                    }
                                });

                                // Add click event listener to set free space image
                                $('#freeSpaceButton').on('click', function() {
                                var freeSpaceNumber = $('#freeSpaceNumber').val();
                                var freeSpaceGeneration = $('#freeSpaceGeneration').val();
                                var freeSpaceGenerationIcon = freeSpaceGeneration;
                                if (['PLA','BDSP','LGPE'].includes(freeSpaceGeneration)) {
                                    freeSpaceGeneration = 'SS';
                                }
                                else if (['FRLG'].includes(freeSpaceGeneration)) {
                                    freeSpaceGeneration = 'RSE';
                                }
                                if (freeSpaceNumber >= 1 && freeSpaceNumber <= 1025) {
                                    var formattedNum = freeSpaceNumber.toString().padStart(3, '0');
                                    var newUrl = 'images/Pokemon/' + freeSpaceGeneration + '/' + formattedNum + '.png';
                                    var iconUrl = 'images/Icons/' + freeSpaceGenerationIcon + '.png';
                                    
                                    // Check if the image exists
                                    var img = new Image();
                                    img.src = newUrl;
                                    img.onload = function() {
                                        $('#freeSpace').attr('src', newUrl);
                                        $('#freeSpaceGen').attr('src', iconUrl);
                                    };
                                    img.onerror = function() {
                                        alert('Number too high for given era. Please enter a valid number.');
                                    };
                                } else {
                                    alert('Please enter a number between 1 and 1025.');
                                }
                            });

                                // Add click event listener to export table as PNG
                                $('#exportButton').on('click', function() {
                                    html2canvas(document.querySelector("#exportArea"), {
                                        logging: true,
                                        scale: 2,
                                        backgroundColor: null
                                    }).then(canvas => {
                                        var link = document.createElement('a');
                                        link.href = canvas.toDataURL();
                                        link.download = 'bingoTable.png';
                                        link.click();
                                    }).catch(function (error) {
                                        console.error('Error capturing the table:', error);
                                    });
                                });
                            });
                        </script>
                </body>
            </html>
            